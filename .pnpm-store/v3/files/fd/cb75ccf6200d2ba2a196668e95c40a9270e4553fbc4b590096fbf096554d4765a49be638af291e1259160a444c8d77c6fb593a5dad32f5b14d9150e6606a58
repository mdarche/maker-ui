{"version":3,"sources":["../../src/is/tabbable.js"],"names":["supports","focusableElementsPattern","isTabbableRules","context","except","flexbox","scrollable","shadow","visible","onlyTabbable","element","label","resolveDocument","is","BLINK","ANDROID","majorVersion","frameElement","WEBKIT","IOS","frameNodeName","nodeName","toLowerCase","isFixedBlink","name","_tabindex","tabindex","EDGE","ownerSVGElement","hasTabbableTabindexOrNone","hasTabbableTabindex","hasAttribute","test","potentiallyTabbable","type","style","window","getComputedStyle","focus","focusSvgNegativeTabindexAttribute","focusSvgInIframe","TRIDENT","focusSvg","focusSvgTabindexAttribute","tabIndex","undefined","Boolean","GECKO","img","isFocusRelevantWithoutFlexbox","isTabbableWithoutFlexbox","parent","parentElement","parentNodeName","parentStyle","isTabbable","rules"],"mappings":"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","file":"tabbable.js","sourcesContent":["\n// determine if an element can be focused by keyboard (i.e. is part of the document's sequential focus navigation order)\n\nimport isVisible from './visible';\nimport contextToElement from '../util/context-to-element';\nimport elementMatches from '../util/element-matches';\nimport tabindexValue from '../util/tabindex-value';\nimport focusRelevant from './focus-relevant';\nimport getFrameElement from '../util/get-frame-element';\nimport platform from '../util/platform';\nimport {getImageOfArea} from '../util/image-map';\nimport {\n  hasCssOverflowScroll,\n  hasCssDisplayFlex,\n  isScrollableContainer,\n  isUserModifyWritable,\n} from './is.util';\n\nimport _supports from '../supports/supports';\nlet supports;\n\n// Internet Explorer 11 considers fieldset, table, td focusable, but not tabbable\n// Internet Explorer 11 considers body to have [tabindex=0], but does not allow tabbing to it\nconst focusableElementsPattern = /^(fieldset|table|td|body)$/;\n\nfunction isTabbableRules({\n  context,\n  except = {\n    flexbox: false,\n    scrollable: false,\n    shadow: false,\n    visible: false,\n    onlyTabbable: false,\n  },\n} = {}) {\n  if (!supports) {\n    supports = _supports();\n  }\n\n  const element = contextToElement({\n    label: 'is/tabbable',\n    resolveDocument: true,\n    context,\n  });\n\n  if (platform.is.BLINK && platform.is.ANDROID && platform.majorVersion > 42) {\n    // External keyboard support worked fine in CHrome 42, but stopped working in Chrome 45.\n    // The on-screen keyboard does not provide a way to focus the next input element (like iOS does).\n    // That leaves us with no option to advance focus by keyboard, ergo nothing is tabbable (keyboard focusable).\n    return false;\n  }\n\n  const frameElement = getFrameElement(element);\n  if (frameElement) {\n    if (platform.is.WEBKIT && platform.is.IOS) {\n      // iOS only does not consider anything from another browsing context keyboard focusable\n      return false;\n    }\n\n    // iframe[tabindex=\"-1\"] and object[tabindex=\"-1\"] inherit the\n    // tabbable demotion onto elements of their browsing contexts\n    if (tabindexValue(frameElement) < 0) {\n      return false;\n    }\n\n    if (!except.visible && (platform.is.BLINK || platform.is.WEBKIT) && !isVisible(frameElement)) {\n      // Blink and WebKit consider elements in hidden browsing contexts focusable, but not tabbable\n      return false;\n    }\n\n    // Webkit and Blink don't consider anything in <object> tabbable\n    // Blink fixed that fixed in Chrome 54, Opera 41\n    const frameNodeName = frameElement.nodeName.toLowerCase();\n    if (frameNodeName === 'object') {\n      const isFixedBlink = (platform.name === 'Chrome' && platform.majorVersion >= 54)\n        || (platform.name === 'Opera' && platform.majorVersion >= 41);\n\n      if (platform.is.WEBKIT || (platform.is.BLINK && !isFixedBlink)) {\n        return false;\n      }\n    }\n  }\n\n  const nodeName = element.nodeName.toLowerCase();\n  const _tabindex = tabindexValue(element);\n  const tabindex = _tabindex === null ? null : _tabindex >= 0;\n\n  if (platform.is.EDGE && platform.majorVersion >= 14 && frameElement && element.ownerSVGElement && _tabindex < 0) {\n    // Edge 14+ considers <a xlink:href=\"â€¦\" tabindex=\"-1\"> keyboard focusable\n    // if the element is in a nested browsing context\n    return true;\n  }\n\n  const hasTabbableTabindexOrNone = tabindex !== false;\n  const hasTabbableTabindex = _tabindex !== null && _tabindex >= 0;\n\n  // NOTE: Firefox 31 considers [contenteditable] to have [tabindex=-1], but allows tabbing to it\n  // fixed in Firefox 40 the latest - https://bugzilla.mozilla.org/show_bug.cgi?id=1185657\n  if (element.hasAttribute('contenteditable')) {\n    // tabbing can still be disabled by explicitly providing [tabindex=\"-1\"]\n    return hasTabbableTabindexOrNone;\n  }\n\n  if (focusableElementsPattern.test(nodeName) && tabindex !== true) {\n    return false;\n  }\n\n  if (platform.is.WEBKIT && platform.is.IOS) {\n    // iOS only considers a hand full of elements tabbable (keyboard focusable)\n    // this holds true even with external keyboards\n    let potentiallyTabbable = (nodeName === 'input' && element.type === 'text' || element.type === 'password')\n      || nodeName === 'select'\n      || nodeName === 'textarea'\n      || element.hasAttribute('contenteditable');\n\n    if (!potentiallyTabbable) {\n      const style = window.getComputedStyle(element, null);\n      potentiallyTabbable = isUserModifyWritable(style);\n    }\n\n    if (!potentiallyTabbable) {\n      return false;\n    }\n  }\n\n  if (nodeName === 'use' && _tabindex !== null) {\n    if (platform.is.BLINK || platform.is.WEBKIT && platform.majorVersion === 9) {\n      // In Chrome and Safari 9 the <use> element is keyboard focusable even for tabindex=\"-1\"\n      return true;\n    }\n  }\n\n  if (elementMatches(element, 'svg a') && element.hasAttribute('xlink:href')) {\n    if (hasTabbableTabindexOrNone) {\n      // in Trident and Gecko SVGElement does not handle the tabIndex property properly\n      return true;\n    }\n\n    if (element.focus && !supports.focusSvgNegativeTabindexAttribute) {\n      // Firefox 51 and 52 treat any natively tabbable SVG element with\n      // tabindex=\"-1\" as tabbable and everything else as inert\n      // see https://bugzilla.mozilla.org/show_bug.cgi?id=1302340\n      return true;\n    }\n  }\n\n  if (nodeName === 'svg' && supports.focusSvgInIframe && hasTabbableTabindexOrNone) {\n    return true;\n  }\n\n  if (platform.is.TRIDENT || platform.is.EDGE) {\n    if (nodeName === 'svg') {\n      if (supports.focusSvg) {\n        // older Internet Explorers consider <svg> keyboard focusable\n        // unless they have focsable=\"false\", but then they wouldn't\n        // be focusable and thus not even reach this filter\n        return true;\n      }\n\n      // elements that have [focusable] are automatically keyboard focusable regardless of the attribute's value\n      return element.hasAttribute('focusable') || hasTabbableTabindex;\n    }\n\n    if (element.ownerSVGElement) {\n      if (supports.focusSvgTabindexAttribute && hasTabbableTabindex) {\n        return true;\n      }\n\n      // elements that have [focusable] are automatically keyboard focusable regardless of the attribute's value\n      return element.hasAttribute('focusable');\n    }\n  }\n  if (element.tabIndex === undefined) {\n    return Boolean(except.onlyTabbable);\n  }\n\n  if (nodeName === 'audio') {\n    if (!element.hasAttribute('controls')) {\n      // In Internet Explorer the <audio> element is focusable, but not tabbable, and tabIndex property is wrong\n      return false;\n    } else if (platform.is.BLINK) {\n      // In Chrome <audio controls tabindex=\"-1\"> remains keyboard focusable\n      return true;\n    }\n  }\n\n  if (nodeName === 'video') {\n    if (!element.hasAttribute('controls')) {\n      if (platform.is.TRIDENT || platform.is.EDGE) {\n        // In Internet Explorer and Edge the <video> element is focusable, but not tabbable, and tabIndex property is wrong\n        return false;\n      }\n    } else if (platform.is.BLINK || platform.is.GECKO) {\n      // In Chrome and Firefox <video controls tabindex=\"-1\"> remains keyboard focusable\n      return true;\n    }\n  }\n\n  if (nodeName === 'object') {\n    if (platform.is.BLINK || platform.is.WEBKIT) {\n      // In all Blink and WebKit based browsers <embed> and <object> are never keyboard focusable, even with tabindex=\"0\" set\n      return false;\n    }\n  }\n\n  if (nodeName === 'iframe') {\n    // In Internet Explorer all iframes are only focusable\n    // In WebKit, Blink and Gecko iframes may be tabbable depending on content.\n    // Since we can't reliably investigate iframe documents because of the\n    // SameOriginPolicy, we're declaring everything only focusable.\n    return false;\n  }\n\n  if (!except.scrollable && platform.is.GECKO) {\n    // Firefox considers scrollable containers keyboard focusable,\n    // even though their tabIndex property is -1\n    const style = window.getComputedStyle(element, null);\n    if (hasCssOverflowScroll(style)) {\n      return hasTabbableTabindexOrNone;\n    }\n  }\n\n  if (platform.is.TRIDENT || platform.is.EDGE) {\n    // IE and Edge degrade <area> to script focusable, if the image\n    // using the <map> has been given tabindex=\"-1\"\n    if (nodeName === 'area') {\n      const img = getImageOfArea(element);\n      if (img && tabindexValue(img) < 0) {\n        return false;\n      }\n    }\n\n    const style = window.getComputedStyle(element, null);\n    if (isUserModifyWritable(style)) {\n      // prevent being swallowed by the overzealous isScrollableContainer() below\n      return element.tabIndex >= 0;\n    }\n\n    if (!except.flexbox && hasCssDisplayFlex(style)) {\n      if (_tabindex !== null) {\n        return hasTabbableTabindex;\n      }\n\n      return isFocusRelevantWithoutFlexbox(element) && isTabbableWithoutFlexbox(element);\n    }\n\n    // IE considers scrollable containers script focusable only,\n    // even though their tabIndex property is 0\n    if (isScrollableContainer(element, nodeName)) {\n      return false;\n    }\n\n    const parent = element.parentElement;\n    if (parent) {\n      const parentNodeName = parent.nodeName.toLowerCase();\n      const parentStyle = window.getComputedStyle(parent, null);\n      // IE considers scrollable bodies script focusable only,\n      if (isScrollableContainer(parent, nodeName, parentNodeName, parentStyle)) {\n        return false;\n      }\n\n      // Children of focusable elements with display:flex are focusable in IE10-11,\n      // even though their tabIndex property suggests otherwise\n      if (hasCssDisplayFlex(parentStyle)) {\n        // value of tabindex takes precedence\n        return hasTabbableTabindex;\n      }\n    }\n  }\n\n  // https://www.w3.org/WAI/PF/aria-practices/#focus_tabindex\n  return element.tabIndex >= 0;\n}\n\n// bind exceptions to an iterator callback\nisTabbableRules.except = function(except = {}) {\n  const isTabbable = function(context) {\n    return isTabbableRules({\n      context,\n      except,\n    });\n  };\n\n  isTabbable.rules = isTabbableRules;\n  return isTabbable;\n};\n\nconst isFocusRelevantWithoutFlexbox = focusRelevant.rules.except({flexbox: true});\nconst isTabbableWithoutFlexbox = isTabbableRules.except({flexbox: true});\n\n// provide isTabbable(context) as default iterator callback\nconst isTabbable = isTabbableRules.except({});\nexport default isTabbable;\n"]}