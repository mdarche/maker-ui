{"version":3,"sources":["../../src/when/visible-area.js"],"names":["context","callback","area","TypeError","element","label","raf","evaluate","disengage","cancelAnimationFrame","predicate","checkPredicate","requestAnimationFrame"],"mappings":";;;;;;;;;;;;;;;;;;;oBAUe,YAAyC;AAAA,mFAAJ,EAAI;AAAA,QAA/BA,OAA+B,QAA/BA,OAA+B;AAAA,QAAtBC,QAAsB,QAAtBA,QAAsB;AAAA,QAAZC,IAAY,QAAZA,IAAY;;AACtD,QAAI,OAAOD,QAAP,KAAoB,UAAxB,EAAoC;AAClC,YAAM,IAAIE,SAAJ,CAAc,8DAAd,CAAN;AACD;;AAED,QAAI,OAAOD,IAAP,KAAgB,QAApB,EAA8B;AAC5BA,aAAO,CAAP;AACD;;AAED,QAAME,UAAU,gCAAiB;AAC/BC,aAAO,mBADwB;AAE/BL;AAF+B,KAAjB,CAAhB;;AAKA,QAAIM,YAAJ;AACA,QAAIC,WAAW,IAAf;AACA,QAAMC,YAAY,SAAZA,SAAY,GAAW;AAC3BF,aAAOG,qBAAqBH,GAArB,CAAP;AACD,KAFD;;AAIA,QAAMI,YAAY,SAAZA,SAAY,GAAW;AAC3B,aAAO,CAAC,uBAAUN,OAAV,CAAD,IAAuB,2BAAYA,OAAZ,IAAuBF,IAA9C,IAAsDD,SAASG,OAAT,MAAsB,KAAnF;AACD,KAFD;;AAIA,QAAMO,iBAAiB,SAAjBA,cAAiB,GAAW;AAChC,UAAID,WAAJ,EAAiB;AACfH;AACA;AACD;;AAEDC;AACD,KAPD;;AASAD,eAAW,oBAAW;AACpBD,YAAMM,sBAAsBD,cAAtB,CAAN;AACD,KAFD;;AAIAJ;AACA,WAAO,EAAEC,oBAAF,EAAP;AACD,G","file":"visible-area.js","sourcesContent":["\n/*\n  execute a callback once an element became fully visible in the viewport\n*/\n\nimport '../prototype/window.requestanimationframe';\nimport isVisible from '../is/visible';\nimport visibleArea from '../util/visible-area';\nimport contextToElement from '../util/context-to-element';\n\nexport default function({context, callback, area} = {}) {\n  if (typeof callback !== 'function') {\n    throw new TypeError('when/visible-area requires options.callback to be a function');\n  }\n\n  if (typeof area !== 'number') {\n    area = 1;\n  }\n\n  const element = contextToElement({\n    label: 'when/visible-area',\n    context,\n  });\n\n  let raf;\n  let evaluate = null;\n  const disengage = function() {\n    raf && cancelAnimationFrame(raf);\n  };\n\n  const predicate = function() {\n    return !isVisible(element) || visibleArea(element) < area || callback(element) === false;\n  };\n\n  const checkPredicate = function() {\n    if (predicate()) {\n      evaluate();\n      return;\n    }\n\n    disengage();\n  };\n\n  evaluate = function() {\n    raf = requestAnimationFrame(checkPredicate);\n  };\n\n  evaluate();\n  return { disengage };\n}\n"]}