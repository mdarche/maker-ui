{"version":3,"sources":["../../src/is/only-tabbable.js"],"names":["isVisible","contextToElement","getFrameElement","tabindexValue","platform","isOnlyTabbableRules","context","except","onlyFocusableBrowsingContext","visible","element","label","resolveDocument","is","GECKO","TRIDENT","EDGE","frameElement","nodeName","toLowerCase","tabindex","ownerSVGElement","focus","hasAttribute","isOnlyTabbable","rules"],"mappings":";AACA,OAAOA,SAAP,MAAsB,WAAtB;AACA,OAAOC,gBAAP,MAA6B,4BAA7B;AACA,OAAOC,eAAP,MAA4B,2BAA5B;AACA,OAAOC,aAAP,MAA0B,wBAA1B;AACA,OAAOC,QAAP,MAAqB,kBAArB;;AAEA,SAASC,mBAAT,GAMQ;AAAA,iFAAJ,EAAI;AAAA,MALNC,OAKM,QALNA,OAKM;AAAA,yBAJNC,MAIM;AAAA,MAJNA,MAIM,+BAJG;AACPC,kCAA8B,KADvB;AAEPC,aAAS;AAFF,GAIH;;AACN,MAAMC,UAAUT,iBAAiB;AAC/BU,WAAO,kBADwB;AAE/BC,qBAAiB,IAFc;AAG/BN;AAH+B,GAAjB,CAAhB;;AAMA,MAAI,CAACC,OAAOE,OAAR,IAAmB,CAACT,UAAUU,OAAV,CAAxB,EAA4C;AAC1C,WAAO,KAAP;AACD;;AAED,MAAI,CAACH,OAAOC,4BAAR,KAAyCJ,SAASS,EAAT,CAAYC,KAAZ,IAAqBV,SAASS,EAAT,CAAYE,OAAjC,IAA4CX,SAASS,EAAT,CAAYG,IAAjG,CAAJ,EAA4G;AAC1G,QAAMC,eAAef,gBAAgBQ,OAAhB,CAArB;AACA,QAAIO,YAAJ,EAAkB;AAChB,UAAId,cAAcc,YAAd,IAA8B,CAAlC,EAAqC;AACnC;AACA;AACA,eAAO,KAAP;AACD;AACF;AACF;;AAED,MAAMC,WAAWR,QAAQQ,QAAR,CAAiBC,WAAjB,EAAjB;AACA,MAAMC,WAAWjB,cAAcO,OAAd,CAAjB;;AAEA,MAAIQ,aAAa,OAAb,IAAwBd,SAASS,EAAT,CAAYC,KAAxC,EAA+C;AAC7C;AACA,WAAOM,aAAa,IAAb,IAAqBA,YAAY,CAAxC;AACD;;AAED;AACA;AACA;AACA,MAAIhB,SAASS,EAAT,CAAYC,KAAZ,IAAqBJ,QAAQW,eAA7B,IAAgD,CAACX,QAAQY,KAA7D,EAAoE;AAClE,QAAIJ,aAAa,GAAb,IAAoBR,QAAQa,YAAR,CAAqB,YAArB,CAAxB,EAA4D;AAC1D;AACA,UAAInB,SAASS,EAAT,CAAYC,KAAhB,EAAuB;AACrB,eAAO,IAAP;AACD;AACF;AACF;;AAED,SAAO,KAAP;AACD;;AAED;AACAT,oBAAoBE,MAApB,GAA6B,YAAsB;AAAA,MAAbA,MAAa,uEAAJ,EAAI;;AACjD,MAAMiB,iBAAiB,SAAjBA,cAAiB,CAASlB,OAAT,EAAkB;AACvC,WAAOD,oBAAoB;AACzBC,sBADyB;AAEzBC;AAFyB,KAApB,CAAP;AAID,GALD;;AAOAiB,iBAAeC,KAAf,GAAuBpB,mBAAvB;AACA,SAAOmB,cAAP;AACD,CAVD;;AAYA;AACA,IAAMA,iBAAiBnB,oBAAoBE,MAApB,CAA2B,EAA3B,CAAvB;AACA,eAAeiB,cAAf","file":"only-tabbable.js","sourcesContent":["\nimport isVisible from './visible';\nimport contextToElement from '../util/context-to-element';\nimport getFrameElement from '../util/get-frame-element';\nimport tabindexValue from '../util/tabindex-value';\nimport platform from '../util/platform';\n\nfunction isOnlyTabbableRules({\n  context,\n  except = {\n    onlyFocusableBrowsingContext: false,\n    visible: false,\n  },\n} = {}) {\n  const element = contextToElement({\n    label: 'is/only-tabbable',\n    resolveDocument: true,\n    context,\n  });\n\n  if (!except.visible && !isVisible(element)) {\n    return false;\n  }\n\n  if (!except.onlyFocusableBrowsingContext && (platform.is.GECKO || platform.is.TRIDENT || platform.is.EDGE)) {\n    const frameElement = getFrameElement(element);\n    if (frameElement) {\n      if (tabindexValue(frameElement) < 0) {\n        // iframe[tabindex=\"-1\"] and object[tabindex=\"-1\"] inherit the\n        // tabbable demotion onto elements of their browsing contexts\n        return false;\n      }\n    }\n  }\n\n  const nodeName = element.nodeName.toLowerCase();\n  const tabindex = tabindexValue(element);\n\n  if (nodeName === 'label' && platform.is.GECKO) {\n    // Firefox cannot focus, but tab to: label[tabindex=0]\n    return tabindex !== null && tabindex >= 0;\n  }\n\n  // SVG Elements were keyboard focusable but not script focusable before Firefox 51.\n  // Firefox 51 added the focus management DOM API (.focus and .blur) to SVGElement,\n  // see https://bugzilla.mozilla.org/show_bug.cgi?id=778654\n  if (platform.is.GECKO && element.ownerSVGElement && !element.focus) {\n    if (nodeName === 'a' && element.hasAttribute('xlink:href')) {\n      // any focusable child of <svg> cannot be focused, but tabbed to\n      if (platform.is.GECKO) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\n// bind exceptions to an iterator callback\nisOnlyTabbableRules.except = function(except = {}) {\n  const isOnlyTabbable = function(context) {\n    return isOnlyTabbableRules({\n      context,\n      except,\n    });\n  };\n\n  isOnlyTabbable.rules = isOnlyTabbableRules;\n  return isOnlyTabbable;\n};\n\n// provide isOnlyTabbable(context) as default iterator callback\nconst isOnlyTabbable = isOnlyTabbableRules.except({});\nexport default isOnlyTabbable;\n"]}