{"version":3,"sources":["../../src/query/shadow-hosts.js"],"names":["queryShadowHosts","filter","node","shadowRoot","NodeFilter","FILTER_ACCEPT","FILTER_SKIP","acceptNode","context","element","label","resolveDocument","defaultToDocument","_document","walker","createTreeWalker","SHOW_ELEMENT","list","push","concat","nextNode","currentNode"],"mappings":";;;;;;;;;;;;;;;;;;oBAgBwBA,gB;;;;;;;;;;;;AAZxB;AACA,MAAMC,SAAS,SAATA,MAAS,CAASC,IAAT,EAAe;AAC5B,QAAIA,KAAKC,UAAT,EAAqB;AACnB,aAAOC,WAAWC,aAAlB;AACD;;AAED,WAAOD,WAAWE,WAAlB;AACD,GAND;AAOA;AACA;AACAL,SAAOM,UAAP,GAAoBN,MAApB;;AAEe,WAASD,gBAAT,GAA4C;AAAA,mFAAJ,EAAI;AAAA,QAAhBQ,OAAgB,QAAhBA,OAAgB;;AACzD,QAAMC,UAAU,gCAAiB;AAC/BC,aAAO,oBADwB;AAE/BC,uBAAiB,IAFc;AAG/BC,yBAAmB,IAHY;AAI/BJ;AAJ+B,KAAjB,CAAhB;;AAOA,QAAMK,YAAY,2BAAYL,OAAZ,CAAlB;AACA;AACA,QAAMM,SAASD,UAAUE,gBAAV;AACb;AACAN,WAFa;AAGb;AACAL,eAAWY,YAJE;AAKb;AACAf,UANa;AAOb;AACA,SARa,CAAf;;AAWA,QAAIgB,OAAO,EAAX;;AAEA,QAAIR,QAAQN,UAAZ,EAAwB;AACtB;AACAc,WAAKC,IAAL,CAAUT,OAAV;AACAQ,aAAOA,KAAKE,MAAL,CAAYnB,iBAAiB;AAClCQ,iBAASC,QAAQN;AADiB,OAAjB,CAAZ,CAAP;AAGD;;AAED,WAAOW,OAAOM,QAAP,EAAP,EAA0B;AACxBH,WAAKC,IAAL,CAAUJ,OAAOO,WAAjB;AACAJ,aAAOA,KAAKE,MAAL,CAAYnB,iBAAiB;AAClCQ,iBAASM,OAAOO,WAAP,CAAmBlB;AADM,OAAjB,CAAZ,CAAP;AAGD;;AAED,WAAOc,IAAP;AACD","file":"shadow-hosts.js","sourcesContent":["\nimport contextToElement from '../util/context-to-element';\nimport getDocument from '../util/get-document';\n\n// see https://developer.mozilla.org/en-US/docs/Web/API/NodeFilter\nconst filter = function(node) {\n  if (node.shadowRoot) {\n    return NodeFilter.FILTER_ACCEPT;\n  }\n\n  return NodeFilter.FILTER_SKIP;\n};\n// IE requires a function, Browsers require {acceptNode: function}\n// see http://www.bennadel.com/blog/2607-finding-html-comment-nodes-in-the-dom-using-treewalker.htm\nfilter.acceptNode = filter;\n\nexport default function queryShadowHosts({ context } = {}) {\n  const element = contextToElement({\n    label: 'query/shadow-hosts',\n    resolveDocument: true,\n    defaultToDocument: true,\n    context,\n  });\n\n  const _document = getDocument(context);\n  // see https://developer.mozilla.org/en-US/docs/Web/API/Document/createTreeWalker\n  const walker = _document.createTreeWalker(\n    // root element to start search in\n    element,\n    // element type filter\n    NodeFilter.SHOW_ELEMENT,\n    // custom NodeFilter filter\n    filter,\n    // deprecated, but IE requires it\n    false\n  );\n\n  let list = [];\n\n  if (element.shadowRoot) {\n    // TreeWalker does not run the filter on the context element\n    list.push(element);\n    list = list.concat(queryShadowHosts({\n      context: element.shadowRoot,\n    }));\n  }\n\n  while (walker.nextNode()) {\n    list.push(walker.currentNode);\n    list = list.concat(queryShadowHosts({\n      context: walker.currentNode.shadowRoot,\n    }));\n  }\n\n  return list;\n}\n"]}